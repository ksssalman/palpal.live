# Development Dockerfile with hot-reload support
FROM node:20-alpine

WORKDIR /app

# Install pnpm for faster installs (optional but recommended)
RUN npm install -g pnpm

# Copy package files for both projects
COPY palpal.live/package*.json ./
COPY projects/work-tracker/package*.json ./projects/work-tracker/

# Install dependencies for main site
RUN npm install

# Install dependencies for work-tracker
WORKDIR /app/projects/work-tracker
RUN npm install

# Copy source code
WORKDIR /app
COPY palpal.live/projects ./projects
COPY palpal.live/src ./src
COPY palpal.live/public ./public
COPY palpal.live/*.html ./
COPY palpal.live/firebase* ./

# Expose Vite dev server port
EXPOSE 5173

# Start development server
CMD ["npm", "run", "dev", "--", "--host", "0.0.0.0"]
